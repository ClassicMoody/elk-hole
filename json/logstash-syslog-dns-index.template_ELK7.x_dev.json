PUT /_template/logstash-syslog-dns
{
  "index_patterns": [
    "logstash-syslog-dns*"
  ],
  "mappings": {
    "dynamic": "true",
    "properties": {
      "source_host": {
        "type": "ip"
      },
      "logrow": {
        "type": "integer"
      },
      "request_from": {
        "type": "ip"
      },
      "source_port": {
        "type": "integer"
      },
      "ip_request": {
        "type": "ip"
      },
      "ip_response": {
        "type": "ip"
      },
      "dns_forward_to": {
        "type": "ip",
        "fields": {
          "keyword": {
            "type": "keyword",
            "ignore_above": 256
          }
        }
      },
      "tags": {
        "type": "keyword",
        "fields": {
          "keyword": {
            "type": "keyword",
            "ignore_above": 256
          }
        }
      },
      "pid": {
        "type": "integer"
      },
      "pihole": {
        "type": "ip"
      },
      "blocked_domain": {
        "type" : "text",
          "norms" : false,
          "fields" : {
            "keyword" : {
              "type" : "keyword",
              "ignore_above" : 256
            }
          }
      },
      "domain_request" : {
          "type" : "text",
          "norms" : false,
          "fields" : {
            "keyword" : {
              "type" : "keyword",
              "ignore_above" : 256
            }
          }
        },
      "date": {
        "type": "date",
        "format": "MMM  d HH:mm:ss||MMM dd HH:mm:ss"
      }
    }
  }
}